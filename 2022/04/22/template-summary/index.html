<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="个人板子总结, Shaun">
    <meta name="description" content="一个自己经常使用的板子的汇总主要是为了自己在需要用的时候能够很快找到对应的板子而写下本篇。
字符串字符串小日记
有种非常妙的思路：后缀转前缀
具体：把字符串 reverse ，再 insert 到 Trie 树里，可模拟后缀。

一定要看清">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>个人板子总结 | Shaun</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 6.0.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Shaun</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>大佬们的博客</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Shaun</div>
        <div class="logo-desc">
            
            welcome
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			大佬们的博客
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/7.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">个人板子总结</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/acm/">
                                <span class="chip bg-color">acm</span>
                            </a>
                        
                            <a href="/tags/%E6%9D%BF%E5%AD%90/">
                                <span class="chip bg-color">板子</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E4%B8%AA%E4%BA%BA%E6%9D%BF%E5%AD%90%E6%80%BB%E7%BB%93/" class="post-category">
                                个人板子总结
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2022-04-22
                </div>
                

                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    6.6k
                </div>
                

                

                
            </div>
        </div>
        <hr class="clearfix">

        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="一个自己经常使用的板子的汇总"><a href="#一个自己经常使用的板子的汇总" class="headerlink" title="一个自己经常使用的板子的汇总"></a>一个自己经常使用的板子的汇总</h1><p>主要是为了自己在需要用的时候能够很快找到对应的板子而写下本篇。</p>
<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><h3 id="字符串小日记"><a href="#字符串小日记" class="headerlink" title="字符串小日记"></a>字符串小日记</h3><ol>
<li><p>有种非常妙的思路：<strong>后缀转前缀</strong></p>
<p>具体：把字符串 <em>reverse</em> ，再 <em>insert</em> 到 <em>Trie</em> 树里，可模拟后缀。</p>
</li>
<li><p><strong>一定要看清楚题目！！！！！！！</strong></p>
<p>一定要看清楚模式串中间有没有重复的串！！！</p>
</li>
<li><p>一定要看清楚具体每个字符串的数据范围，一般 <strong>MAXX</strong> 表示有几个串，但是最后的文本串可能会是 $1e6$ 的。</p>
</li>
<li><p>感觉字符串的题目一般很难直接抄板子，除了一些固定的步骤， <strong>一般都要从头手打一遍</strong> ，因为每次题目中的要求，条件等等都会变，一定要深度理解算法的思想，到时候做题才能更灵活。</p>
</li>
<li><p>字符串的题目灵活性太高了，可以试试<strong>从多个不同的角度进行思考</strong>。感觉很多题目都是会有很多种解法(优化方法)。</p>
</li>
<li><p>如果有时间的话，一定要<strong>多复习复习</strong>前面学过的内容，这些东西太容易忘了。</p>
</li>
<li><p>要多变通，<strong>不要死磕一种死方法</strong>。</p>
</li>
</ol>
<h3 id="一些常用结论和技巧"><a href="#一些常用结论和技巧" class="headerlink" title="一些常用结论和技巧"></a>一些常用结论和技巧</h3><ol>
<li><p>一个长度为 $n$ 的字符串一共有 $\frac{n(n+1)}{2}$ 个子串。</p>
</li>
<li><p>字符串中重复了的子串的个数等于 $\sum_{i=1}^{n} height[i]$ ，故一个字符串的所有不同子串个数就等于</p>
<p> $\frac{n(n+1)}{2}-\sum_{i=1}^{n} height[i]$ 。</p>
</li>
<li><p>多次询问字串 $s(l,r)$ 的出现次数</p>
<p>二分+$SA$</p>
</li>
<li><p>最长重复子串（可重叠）</p>
<p>$ans=\max{height[i]}$ </p>
</li>
<li><p>两个字符串的最长公共子串</p>
<p>记录每一次的公共子串的长度</p>
<p>大致思路为下图，对角线即为重复子串。</p>
<p><img src="/2022/04/22/template-summary/skill5.jpg" alt="img"></p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</span><br><span class="line">        len[i][j]=((a[i]==s[j])?(len[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>):(<span class="number">0</span>));</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>waiting</p>
</li>
</ol>
<h3 id="SAM使用技巧"><a href="#SAM使用技巧" class="headerlink" title="SAM使用技巧"></a>SAM使用技巧</h3><ol>
<li><p>在 $SAM$ 中 $len[i]-len[fa[i]]$ 表示 $sam[i]$ 中表示了几个字符串。</p>
</li>
<li><p>记录每个子串的出现次数(求 $|Right[s]|$ )</p>
<ul>
<li>在 <em>add</em> 模板中要有初始化 $num[np]=1$ 。</li>
<li>构造出 <em>parent树</em> 。</li>
<li>直接 <em>dfs</em> 。</li>
</ul>
<p>例子：</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vector&lt;<span class="keyword">int</span>&gt; to[MAXX&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now)</span></span>{</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> jj:to[now]){</span><br><span class="line">		<span class="built_in">dfs</span>(jj);</span><br><span class="line">		num[now]+=num[jj];</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sam_cnt;++i)</span><br><span class="line">    to[sam[i].fa].<span class="built_in">emplace_back</span>(i);</span><br><span class="line"><span class="built_in">dfs</span>(<span class="number">1</span>);</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>多少个本质不同的子串</p>
<ul>
<li>在 $SAM$ 上从根节点开始的每一条路径都是一个子串且不重复，故直接在 $SAM$ 上跑 $DP$ 即可。</li>
</ul>
<p>例子：</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LL ans[MAXX&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="function">LL <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(ans[now]) <span class="keyword">return</span> ans[now];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)</span><br><span class="line">		<span class="keyword">if</span>(sam[now].ch[i])</span><br><span class="line">			ans[now]+=<span class="built_in">dfs</span>(sam[now].ch[i]);</span><br><span class="line">	<span class="keyword">return</span> ++ans[now];</span><br><span class="line">}</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,<span class="built_in">dfs</span>(<span class="number">1</span>)<span class="number">-1</span>);</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>两个字符串的<strong>本质不同公共子串个数</strong></p>
<ul>
<li>两个字符串依此插入到同一个 $sam$ 中，但是，每开始一个新的子串，就得将 $las=1$ ，达到从这个字符串的开头开始的效果。</li>
<li>$add$ 操作也要加一个标记，在结构体中新加变量 $bool\ vis[2]$ ，用于标记在哪个串中出现过没有。</li>
<li>在 $add$ 函数最后一行加上 <code>for(;np&amp;&amp;!sam[np].vis[jj];np=sam[np].fa) sam[np].vis[jj]=true;</code> ，即可达到标记的效果。</li>
<li>最后遍历一遍 $sam$ 中的每一个点，如果这个点表示的状态的 $vis[0]==true&amp;&amp;vis[1]==true$ ，就 $ans+=sam[i].len-sam[sam[i].fa].len$。</li>
</ul>
<p>例子：</p>
<figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> c,<span class="keyword">int</span> jj)</span></span>{</span><br><span class="line">	...</span><br><span class="line">    <span class="keyword">for</span>(;np&amp;&amp;!sam[np].vis[jj];np=sam[np].fa) sam[np].vis[jj]=<span class="literal">true</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">2</span>;++i){</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>,s+<span class="number">1</span>);<span class="built_in">getchar</span>();</span><br><span class="line">		n=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">		las=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;++j)</span><br><span class="line">			<span class="built_in">add</span>(s[j]-<span class="string">'a'</span>,i<span class="number">-1</span>);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=sam_cnt;++i)</span><br><span class="line">		<span class="keyword">if</span>(sam[i].vis[<span class="number">0</span>]&amp;&amp;sam[i].vis[<span class="number">1</span>])</span><br><span class="line">			ans+=sam[i].len-sam[sam[i].fa].len;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,ans);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></li>
<li><p>如果有多个匹配串与一个模式串进行子串匹配，那么可以只对模式串进行建立 $SAM$ ，之后对于每一个匹配串，使用类似于 $trie树$ 的匹配方式进行匹配。之后可以使用动态规划的思想，搞出最长匹配长度。</p>
</li>
<li><p>对于有 $m$ 次操作且 $m$ 很大且会改变原字符串的情况，我们可以考虑<strong>定期重构</strong>。</p>
<p>设 $T=\sqrt n$ ，每 $T$ 次添加或删除字符操作后，就重构 $SAM$ 。对于还没有来得及重构的询问，我们使用字符串 $Hash$ 来进行解决。</p>
<p>对于对字符串前面添加新字符还是前面删除字符都适用。</p>
</li>
</ol>
<h3 id="KMP模板"><a href="#KMP模板" class="headerlink" title="KMP模板"></a>KMP模板</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> l[MAXX],s[MAXX];</span><br><span class="line"><span class="keyword">int</span> lenl,lens,p[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getpmt</span><span class="params">()</span></span>{</span><br><span class="line">	p[<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>;i&lt;lenl;++i){</span><br><span class="line">		<span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;s[i+<span class="number">1</span>]!=s[j+<span class="number">1</span>])</span><br><span class="line">			j=p[j];</span><br><span class="line">		<span class="keyword">if</span>(s[i+<span class="number">1</span>]==s[j+<span class="number">1</span>])</span><br><span class="line">			++j;</span><br><span class="line">		p[i+<span class="number">1</span>]=j;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getans</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;i&lt;lenl;++i){</span><br><span class="line">		<span class="keyword">while</span>(j&gt;<span class="number">0</span>&amp;&amp;l[i+<span class="number">1</span>]!=s[j+<span class="number">1</span>])</span><br><span class="line">			j=p[j];</span><br><span class="line">		<span class="keyword">if</span>(l[i+<span class="number">1</span>]==s[j+<span class="number">1</span>])</span><br><span class="line">			++j;</span><br><span class="line">		<span class="keyword">if</span>(j==lens){</span><br><span class="line">			<span class="comment">//dosomething</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,i-j+<span class="number">2</span>);</span><br><span class="line">			<span class="comment">//</span></span><br><span class="line">			j=p[j];</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="KMP求最小循环节"><a href="#KMP求最小循环节" class="headerlink" title="KMP求最小循环节"></a>KMP求最小循环节</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先要求出p数组（即next数组）</span></span><br><span class="line"><span class="comment">//字符串长度为len</span></span><br><span class="line"><span class="comment">//循环节的长度为</span></span><br><span class="line"><span class="keyword">int</span> l=len-p[len];</span><br></pre></td></tr></tbody></table></figure>



<h3 id="KMP求所有循环节"><a href="#KMP求所有循环节" class="headerlink" title="KMP求所有循环节"></a>KMP求所有循环节</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> jj=p[n];</span><br><span class="line"><span class="keyword">while</span>(jj!=<span class="number">0</span>){</span><br><span class="line">    ans.<span class="built_in">emplace_back</span>(n-jj);<span class="comment">//这里的 n-jj 均为循环节，ans记录所有循环节</span></span><br><span class="line">    jj=p[jj];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="扩展KMP"><a href="#扩展KMP" class="headerlink" title="扩展KMP"></a>扩展KMP</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//int z[MAXX],p[MAXX];</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Z</span><span class="params">(<span class="keyword">char</span>* s,<span class="keyword">int</span> n)</span></span>{</span><br><span class="line">	z[<span class="number">1</span>]=n;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) z[i]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>,l=<span class="number">0</span>,r=<span class="number">0</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="keyword">if</span>(i&lt;=r) z[i]=<span class="built_in">min</span>(z[i-l+<span class="number">1</span>],r-i+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">while</span>(i+z[i]&lt;=n&amp;&amp;s[i+z[i]]==s[z[i]+<span class="number">1</span>]) ++z[i];</span><br><span class="line">		<span class="keyword">if</span>(i+z[i]<span class="number">-1</span>&gt;r) l=i,r=i+z[i]<span class="number">-1</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exkmp</span><span class="params">(<span class="keyword">char</span>* a,<span class="keyword">int</span> n,<span class="keyword">char</span>* s,<span class="keyword">int</span> m)</span></span>{</span><br><span class="line">	<span class="built_in">Z</span>(s,m);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) p[i]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,l=<span class="number">0</span>,r=<span class="number">0</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="keyword">if</span>(i&lt;=r) p[i]=<span class="built_in">min</span>(z[i-l+<span class="number">1</span>],r-i+<span class="number">1</span>);</span><br><span class="line">		<span class="keyword">while</span>(i+p[i]&lt;=n&amp;&amp;a[i+p[i]]==s[p[i]+<span class="number">1</span>]) ++p[i];</span><br><span class="line">		<span class="keyword">if</span>(i+p[i]<span class="number">-1</span>&gt;r) l=i,r=i+p[i]<span class="number">-1</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="comment">//exkmp(a,n,s,m);</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="字符串-Hash"><a href="#字符串-Hash" class="headerlink" title="字符串 $Hash$"></a>字符串 $Hash$</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">unsigned</span> <span class="keyword">long</span> <span class="keyword">long</span> ull;</span><br><span class="line"><span class="comment">//prim 是自己设置的一个素数,具体数值根据情况而定</span></span><br><span class="line">ull p[MAXX],hashs[MAXX],prim=<span class="number">233</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">    p[<span class="number">0</span>]=<span class="number">1ull</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;MAXX;++i)</span><br><span class="line">        p[i]=p[i<span class="number">-1</span>]*prim;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> ull <span class="title">gethash</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> hashs[r]-hashs[l<span class="number">-1</span>]*p[r-l+<span class="number">1</span>];</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,ull jj)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">gethash</span>(l,r)==jj;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// for(int i=1;i&lt;=n;++i)</span></span><br><span class="line"><span class="comment">//     hashs[i]=hashs[i-1]*prim+s[i];</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="Trie树-字典树"><a href="#Trie树-字典树" class="headerlink" title="Trie树(字典树)"></a>Trie树(字典树)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Trie树更重要的是思路</span></span><br><span class="line"><span class="comment">碰到题目一般不会直接这样考模板</span></span><br><span class="line"><span class="comment">要灵活变通</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trie</span>{</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">static</span> <span class="keyword">int</span> maxid=MAXX*<span class="number">50</span>;</span><br><span class="line">	<span class="keyword">int</span> trie[maxid][<span class="number">26</span>],id_cnt;</span><br><span class="line">	<span class="keyword">bool</span> is_word[maxid];</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Trie</span>();</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">char</span>* jj)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">char</span>* jj)</span></span>;</span><br><span class="line">};</span><br><span class="line">Trie::<span class="built_in">Trie</span>(){</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;maxid;++i)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">26</span>;++j)</span><br><span class="line">			trie[i][j]=<span class="number">0</span>;</span><br><span class="line">	id_cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;maxid;++i)</span><br><span class="line">		is_word[i]=<span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Trie::insert</span><span class="params">(<span class="keyword">char</span>* jj)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> now=<span class="number">0</span>,len=<span class="built_in">strlen</span>(jj+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		<span class="keyword">if</span>(trie[now][jj[i]-<span class="string">'a'</span>]==<span class="number">0</span>)</span><br><span class="line">			trie[now][jj[i]-<span class="string">'a'</span>]=++id_cnt;</span><br><span class="line">		now=trie[now][jj[i]-<span class="string">'a'</span>];</span><br><span class="line">	}</span><br><span class="line">	is_word[now]=<span class="literal">true</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Trie::find</span><span class="params">(<span class="keyword">char</span>* jj)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> now=<span class="number">0</span>,len=<span class="built_in">strlen</span>(jj+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		<span class="keyword">if</span>(trie[now][jj[i]-<span class="string">'a'</span>]==<span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		now=trie[now][jj[i]-<span class="string">'a'</span>];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> is_word[now];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="Border树-next树-概念及性质"><a href="#Border树-next树-概念及性质" class="headerlink" title="Border树(next树) 概念及性质"></a>Border树(next树) 概念及性质</h3><p><strong>概念</strong></p>
<p>一个字符串长度为 $n$ 。</p>
<p>在 <em>Border</em> 树中，共有 $n+1$ 个节点， $0$ 是这棵有向树的根节点，对于其他每个点 $1 \le i \le n$ ，父节点为 $next[i]$ 。</p>
<p><strong>性质</strong></p>
<ol>
<li>每个前缀 $Prefix[i]$ 的所有 $Border$ : 节点 $i$ 到根的链。</li>
<li>哪些前缀有长度为 $x$ 的 $Border$ : $x$ 的子树。</li>
<li>求两个前缀的公共 $Border$ 等价于求 $LCA$ 。</li>
</ol>
<h3 id="AC自动机"><a href="#AC自动机" class="headerlink" title="AC自动机"></a>AC自动机</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> id_max=MAXX;</span><br><span class="line"><span class="keyword">int</span> n,flag[id_max],fail[id_max];</span><br><span class="line"><span class="keyword">int</span> trie[id_max][<span class="number">26</span>],id_cnt;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; id[id_max];</span><br><span class="line"><span class="keyword">char</span> s[MAXX];</span><br><span class="line"><span class="keyword">int</span> num[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化，用于多组数据输入 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">	id_cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;id_max;++i){</span><br><span class="line">		flag[i]=fail[i]=<span class="number">0</span>;</span><br><span class="line">		id[i].<span class="built_in">clear</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">26</span>;++j)</span><br><span class="line">			trie[i][j]=<span class="number">0</span>;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//向插入字典树中插入一个单词 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">char</span> s[])</span></span>{</span><br><span class="line">	<span class="keyword">int</span> len=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">int</span> now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		<span class="keyword">if</span>(trie[now][s[i]-<span class="string">'a'</span>]==<span class="number">0</span>)</span><br><span class="line">			trie[now][s[i]-<span class="string">'a'</span>]=++id_cnt;</span><br><span class="line">		now=trie[now][s[i]-<span class="string">'a'</span>];</span><br><span class="line">	}</span><br><span class="line">	++flag[now];</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//向插入字典树中插入一个单词，并与输入顺序进行链接 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">char</span> s[],<span class="keyword">int</span> idd)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> len=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">int</span> now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		<span class="keyword">if</span>(trie[now][s[i]-<span class="string">'a'</span>]==<span class="number">0</span>)</span><br><span class="line">			trie[now][s[i]-<span class="string">'a'</span>]=++id_cnt;</span><br><span class="line">		now=trie[now][s[i]-<span class="string">'a'</span>];</span><br><span class="line">	}</span><br><span class="line">	id[now].<span class="built_in">emplace_back</span>(idd);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> bfsn[id_max];<span class="comment">//bfs序 </span></span><br><span class="line"><span class="comment">//链接fail指针 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">()</span></span>{</span><br><span class="line">	queue&lt;<span class="keyword">int</span>&gt; qq;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i)</span><br><span class="line">		<span class="keyword">if</span>(trie[<span class="number">0</span>][i])</span><br><span class="line">			qq.<span class="built_in">emplace</span>(trie[<span class="number">0</span>][i]);</span><br><span class="line">	<span class="keyword">int</span> bfs_cnt=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(!qq.<span class="built_in">empty</span>()){</span><br><span class="line">		<span class="keyword">int</span> now=qq.<span class="built_in">front</span>();qq.<span class="built_in">pop</span>();</span><br><span class="line">		bfsn[++bfs_cnt]=now;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;++i){</span><br><span class="line">			<span class="keyword">if</span>(trie[now][i]){</span><br><span class="line">				fail[trie[now][i]]=trie[fail[now]][i];</span><br><span class="line">				qq.<span class="built_in">emplace</span>(trie[now][i]);</span><br><span class="line">			}</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				trie[now][i]=trie[fail[now]][i];</span><br><span class="line">		}</span><br><span class="line"><span class="comment">//		int fa=fail[now];</span></span><br><span class="line"><span class="comment">//		id[now].insert(id[now].end(),id[fa].begin(),id[fa].end());</span></span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//返回字典中有多少个单词在s串中出现过 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getone</span><span class="params">(<span class="keyword">char</span> s[])</span></span>{</span><br><span class="line">	<span class="keyword">int</span> now=<span class="number">0</span>,len=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		now=trie[now][s[i]-<span class="string">'a'</span>];</span><br><span class="line">		<span class="keyword">int</span> jj=now;</span><br><span class="line">		<span class="keyword">while</span>(jj&gt;<span class="number">0</span>&amp;&amp;flag[jj]!=<span class="number">-1</span>){</span><br><span class="line">			ret+=flag[jj];</span><br><span class="line">			flag[jj]=<span class="number">-1</span>;</span><br><span class="line">			jj=fail[jj];</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> nnum[id_max];</span><br><span class="line"><span class="comment">//需事先定义num数组，用于保存每个单词在s串中出现过几次 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getnum</span><span class="params">(<span class="keyword">char</span> s[])</span></span>{</span><br><span class="line">	<span class="built_in">memset</span>(num,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(num));</span><br><span class="line">	<span class="keyword">int</span> now=<span class="number">0</span>,len=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		now=trie[now][s[i]-<span class="string">'a'</span>];</span><br><span class="line">		++nnum[now];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=id_cnt;i&gt;<span class="number">0</span>;--i){</span><br><span class="line">		<span class="keyword">int</span> now=bfsn[i];</span><br><span class="line">		nnum[fail[now]]+=nnum[now];</span><br><span class="line">			<span class="keyword">int</span> si=id[now].<span class="built_in">size</span>();</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;si;++j)</span><br><span class="line">				num[id[now][j]]+=nnum[now];</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="manacher"><a href="#manacher" class="headerlink" title="manacher"></a>manacher</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//需事先定义好 char s[MAXX],a[MAXX*2]; </span></span><br><span class="line"><span class="comment">//和 int ans[MAXX*2]; </span></span><br><span class="line"><span class="comment">//s串是原字符串，a串用来存改变后的字符串，在该函数里面有实现</span></span><br><span class="line"><span class="comment">//ans存改变后的串的以i为中心的最长的回文串的回文半径 </span></span><br><span class="line"><span class="comment">//返回值为最长回文半径（对于原字符串来说） </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">manacher</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> lens=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">int</span> len=<span class="number">0</span>;</span><br><span class="line">	a[<span class="number">0</span>]=<span class="string">'@'</span>;a[<span class="number">1</span>]=<span class="string">'#'</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=lens;++i){</span><br><span class="line">		a[len++]=s[i];</span><br><span class="line">		a[len++]=<span class="string">'#'</span>;</span><br><span class="line">	}</span><br><span class="line">	a[len]=<span class="string">'%'</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> r=<span class="number">0</span>,mid=<span class="number">0</span>,ret=<span class="number">1</span>;</span><br><span class="line">	ans[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		<span class="keyword">if</span>(i&lt;r)</span><br><span class="line">			ans[i]=<span class="built_in">min</span>(r-i+<span class="number">1</span>,ans[mid*<span class="number">2</span>-i]);</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			ans[i]=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">while</span>(a[i-ans[i]]==a[i+ans[i]])</span><br><span class="line">			++ans[i];</span><br><span class="line">		<span class="keyword">if</span>(r&lt;i+ans[i]<span class="number">-1</span>){</span><br><span class="line">			mid=i;</span><br><span class="line">			r=mid+ans[i]<span class="number">-1</span>;</span><br><span class="line">		}</span><br><span class="line">		</span><br><span class="line">		ret=<span class="built_in">max</span>(ret,ans[i]);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> (ret*<span class="number">2</span><span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="manacher-易于改动版"><a href="#manacher-易于改动版" class="headerlink" title="manacher(易于改动版)"></a>manacher(易于改动版)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">manacher</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> len=lens*<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=len;++i){</span><br><span class="line">		a[i]=<span class="string">'#'</span>;</span><br><span class="line">		ans[i]=<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=lens;++i)</span><br><span class="line">		a[i*<span class="number">2</span><span class="number">-1</span>]=s[i];</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">int</span> l=<span class="number">1</span>,mid=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	ans[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">		<span class="keyword">if</span>(i&gt;mid+l<span class="number">-1</span>){</span><br><span class="line">			<span class="keyword">int</span> jj=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">while</span>(i+jj<span class="number">-1</span>&lt;=len&amp;&amp;i-jj+<span class="number">1</span>&gt;=<span class="number">0</span>&amp;&amp;a[i+jj<span class="number">-1</span>]==a[i-jj+<span class="number">1</span>])</span><br><span class="line">				++jj;</span><br><span class="line">			mid=i;</span><br><span class="line">			l=jj<span class="number">-1</span>;</span><br><span class="line">			ans[i]=jj<span class="number">-1</span>;</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span>{</span><br><span class="line">			<span class="keyword">int</span> j=mid*<span class="number">2</span>-i;</span><br><span class="line">			<span class="keyword">if</span>(j-ans[j]+<span class="number">1</span>&gt;mid-l+<span class="number">1</span>)</span><br><span class="line">				ans[i]=ans[j];</span><br><span class="line">			<span class="keyword">else</span>{</span><br><span class="line">				<span class="keyword">int</span> jj=mid+l-i;</span><br><span class="line">				<span class="keyword">while</span>(i+jj<span class="number">-1</span>&lt;=len&amp;&amp;i-jj+<span class="number">1</span>&gt;=<span class="number">0</span>&amp;&amp;a[i+jj<span class="number">-1</span>]==a[i-jj+<span class="number">1</span>])</span><br><span class="line">					++jj;</span><br><span class="line">				ans[i]=jj<span class="number">-1</span>;</span><br><span class="line">				<span class="keyword">if</span>(i+ans[i]&gt;mid+l){</span><br><span class="line">					mid=i;</span><br><span class="line">					l=jj<span class="number">-1</span>;</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		ret=<span class="built_in">max</span>(ret,ans[i]);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> (ret*<span class="number">2</span><span class="number">-1</span>)/<span class="number">2</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="PAM"><a href="#PAM" class="headerlink" title="PAM"></a>PAM</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PamNode</span>{</span></span><br><span class="line">    <span class="keyword">int</span> ch[<span class="number">26</span>];</span><br><span class="line">    <span class="keyword">int</span> num;<span class="comment">//该位置为结尾的回文串个数</span></span><br><span class="line">    <span class="keyword">int</span> sum;<span class="comment">//该节点表示的回文串出现的数量</span></span><br><span class="line">    <span class="keyword">int</span> fail,len;</span><br><span class="line">    <span class="built_in">PamNode</span>(){<span class="built_in">memset</span>(ch,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(ch));num=fail=len=sum=<span class="number">0</span>;}</span><br><span class="line">}pam[MAXX];</span><br><span class="line"><span class="keyword">int</span> pam_cnt=<span class="number">0</span>,last=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> s[MAXX];<span class="comment">//the string</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=pam_cnt;++i)</span><br><span class="line">        pam[i]=<span class="built_in">PamNode</span>();</span><br><span class="line">    pam[<span class="number">0</span>].len=<span class="number">0</span>;pam[<span class="number">1</span>].len=<span class="number">-1</span>;</span><br><span class="line">    pam[<span class="number">0</span>].fail=<span class="number">1</span>;pam[<span class="number">1</span>].fail=<span class="number">0</span>;</span><br><span class="line">    last=<span class="number">0</span>;pam_cnt=<span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">getfail</span><span class="params">(<span class="keyword">int</span> id,<span class="keyword">int</span> las)</span></span>{</span><br><span class="line">    <span class="keyword">while</span>(s[id-pam[las].len<span class="number">-1</span>]!=s[id])</span><br><span class="line">        las=pam[las].fail;</span><br><span class="line">    <span class="keyword">return</span> las;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> id)</span></span>{</span><br><span class="line">    <span class="keyword">int</span> p=<span class="built_in">getfail</span>(id,last);</span><br><span class="line">    <span class="keyword">if</span>(!pam[p].ch[s[id]-<span class="string">'a'</span>]){</span><br><span class="line">        pam[++pam_cnt].len=pam[p].len+<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> jj=<span class="built_in">getfail</span>(id,pam[p].fail);</span><br><span class="line">        pam[pam_cnt].fail=pam[jj].ch[s[id]-<span class="string">'a'</span>];</span><br><span class="line">        pam[pam_cnt].num=pam[pam[pam_cnt].fail].num+<span class="number">1</span>;</span><br><span class="line">        pam[p].ch[s[id]-<span class="string">'a'</span>]=pam_cnt;</span><br><span class="line">    }</span><br><span class="line">    last=pam[p].ch[s[id]-<span class="string">'a'</span>];</span><br><span class="line">    ++pam[last].sum;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="built_in">init</span>();<span class="comment">//init</span></span><br><span class="line">    <span class="keyword">int</span> len=<span class="built_in">strlen</span>(s+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;++i){</span><br><span class="line">        <span class="built_in">add</span>(i);</span><br><span class="line">        <span class="comment">//do something or not</span></span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=pam_cnt;i&gt;<span class="number">1</span>;--i)</span><br><span class="line">        pam[pam[i].fail].sum+=pam[i].sum;</span><br><span class="line">}</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">scanf("%s",s+1);</span></span><br><span class="line"><span class="comment">build();</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="SA-amp-amp-LCP-st表"><a href="#SA-amp-amp-LCP-st表" class="headerlink" title="SA&amp;&amp;LCP(st表)"></a>SA&amp;&amp;LCP(st表)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">char</span> s[MAXX];</span><br><span class="line"><span class="keyword">int</span> x[MAXX],y[MAXX],c[MAXX],sa[MAXX];</span><br><span class="line"><span class="keyword">int</span> rk[MAXX],height[MAXX];</span><br><span class="line"><span class="keyword">int</span> mn[MAXX],stmin[MAXX][<span class="number">22</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//后缀数组</span></span><br><span class="line"><span class="comment">//需事先定义</span></span><br><span class="line"><span class="comment">//int x[],y[],c[],sa[]; </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SA</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> m=<span class="string">'z'</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ++c[x[i]=s[i]];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=m;++i) c[i]+=c[i<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;--i) sa[c[x[i]]--]=i;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k&lt;&lt;=<span class="number">1</span>){</span><br><span class="line">		<span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=n-k+<span class="number">1</span>;i&lt;=n;++i) y[++num]=i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(sa[i]&gt;k) y[++num]=sa[i]-k;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) c[i]=<span class="number">0</span>;<span class="comment">//init</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ++c[x[i]];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=m;++i) c[i]+=c[i<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;--i) sa[c[x[y[i]]]--]=y[i],y[i]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">swap</span>(x[i],y[i]);</span><br><span class="line">		x[sa[<span class="number">1</span>]]=<span class="number">1</span>;num=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">			x[sa[i]]=(y[sa[i]]==y[sa[i<span class="number">-1</span>]]&amp;&amp;y[sa[i]+k]==y[sa[i<span class="number">-1</span>]+k])?num:++num;</span><br><span class="line">		<span class="keyword">if</span>(num==n) <span class="keyword">break</span>;</span><br><span class="line">		m=num;</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//需事先定义 </span></span><br><span class="line"><span class="comment">//int rk[],height[];</span></span><br><span class="line"><span class="comment">//int mn[MAXX],stmin[MAXX][22];</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LCP</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> h=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) rk[sa[i]]=i;<span class="comment">//init</span></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="keyword">if</span>(rk[i]==<span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="keyword">if</span>(h) --h;</span><br><span class="line">		<span class="keyword">int</span> j=sa[rk[i]<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">while</span>(i+h&lt;=n&amp;&amp;j+h&lt;=n&amp;&amp;s[i+h]==s[j+h]) ++h;</span><br><span class="line">		height[rk[i]]=h;</span><br><span class="line">	}</span><br><span class="line">	<span class="comment">//st表init </span></span><br><span class="line">	mn[<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		mn[i]=((i&amp;(i<span class="number">-1</span>))==<span class="number">0</span>)?mn[i<span class="number">-1</span>]+<span class="number">1</span>:mn[i<span class="number">-1</span>];</span><br><span class="line">		stmin[i][<span class="number">0</span>]=height[i];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=mn[n];++j)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;++i)</span><br><span class="line">			stmin[i][j]=<span class="built_in">min</span>(stmin[i][j<span class="number">-1</span>],stmin[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getstmin</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> k=mn[r-l+<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">min</span>(stmin[l][k],stmin[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getlcp</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(l==r) <span class="keyword">return</span> n-l+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">getstmin</span>(<span class="built_in">min</span>(rk[l],rk[r])+<span class="number">1</span>,<span class="built_in">max</span>(rk[l],rk[r]));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="SA-amp-amp-LCP-st-封装成类"><a href="#SA-amp-amp-LCP-st-封装成类" class="headerlink" title="SA&amp;&amp;LCP(st)(封装成类)"></a>SA&amp;&amp;LCP(st)(封装成类)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SuffixArray</span>{</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> n;</span><br><span class="line">	<span class="keyword">int</span> x[MAXX],y[MAXX],c[MAXX],sa[MAXX];</span><br><span class="line">	<span class="keyword">int</span> rk[MAXX],height[MAXX];</span><br><span class="line">	<span class="keyword">int</span> mn[MAXX],stmin[MAXX][<span class="number">22</span>];</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">SA</span><span class="params">()</span></span>{</span><br><span class="line">		<span class="keyword">int</span> m=<span class="string">'z'</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) c[i]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ++c[x[i]=s[i]];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=m;++i) c[i]+=c[i<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;--i) sa[c[x[i]]--]=i;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>;k&lt;=n;k&lt;&lt;=<span class="number">1</span>){</span><br><span class="line">			<span class="keyword">int</span> num=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=n-k+<span class="number">1</span>;i&lt;=n;++i) y[++num]=i;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(sa[i]&gt;k) y[++num]=sa[i]-k;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i) c[i]=<span class="number">0</span>;<span class="comment">//init</span></span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ++c[x[i]];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=m;++i) c[i]+=c[i<span class="number">-1</span>];</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=n;i&gt;=<span class="number">1</span>;--i) sa[c[x[y[i]]]--]=y[i],y[i]=<span class="number">0</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">swap</span>(x[i],y[i]);</span><br><span class="line">			x[sa[<span class="number">1</span>]]=<span class="number">1</span>;num=<span class="number">1</span>;</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i)</span><br><span class="line">				x[sa[i]]=(y[sa[i]]==y[sa[i<span class="number">-1</span>]]&amp;&amp;y[sa[i]+k]==y[sa[i<span class="number">-1</span>]+k])?num:++num;</span><br><span class="line">			<span class="keyword">if</span>(num==n) <span class="keyword">break</span>;</span><br><span class="line">			m=num;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">LCP</span><span class="params">()</span></span>{</span><br><span class="line">		<span class="keyword">int</span> h=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i) rk[sa[i]]=i;<span class="comment">//init</span></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">			<span class="keyword">if</span>(rk[i]==<span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>(h) --h;</span><br><span class="line">			<span class="keyword">int</span> j=sa[rk[i]<span class="number">-1</span>];</span><br><span class="line">			<span class="keyword">while</span>(i+h&lt;=n&amp;&amp;j+h&lt;=n&amp;&amp;s[i+h]==s[j+h]) ++h;</span><br><span class="line">			height[rk[i]]=h;</span><br><span class="line">		}</span><br><span class="line">		<span class="comment">//st表init </span></span><br><span class="line">		mn[<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">			mn[i]=((i&amp;(i<span class="number">-1</span>))==<span class="number">0</span>)?mn[i<span class="number">-1</span>]+<span class="number">1</span>:mn[i<span class="number">-1</span>];</span><br><span class="line">			stmin[i][<span class="number">0</span>]=height[i];</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=mn[n];++j)</span><br><span class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;++i)</span><br><span class="line">				stmin[i][j]=<span class="built_in">min</span>(stmin[i][j<span class="number">-1</span>],stmin[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getstmin</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">		<span class="keyword">int</span> k=mn[r-l+<span class="number">1</span>];</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">min</span>(stmin[l][k],stmin[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">	}</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getlcp</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">		<span class="keyword">if</span>(l==r) <span class="keyword">return</span> n-l+<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">getstmin</span>(<span class="built_in">min</span>(rk[l],rk[r])+<span class="number">1</span>,<span class="built_in">max</span>(rk[l],rk[r]));</span><br><span class="line">	}</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>



<h3 id="SAM"><a href="#SAM" class="headerlink" title="SAM"></a>SAM</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SamNode</span>{</span></span><br><span class="line">	<span class="keyword">int</span> ch[<span class="number">26</span>];</span><br><span class="line">	<span class="keyword">int</span> len,fa;</span><br><span class="line">	<span class="built_in">SamNode</span>(){<span class="built_in">memset</span>(ch,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(ch));len=<span class="number">0</span>;}</span><br><span class="line">}sam[MAXX&lt;&lt;<span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> las=<span class="number">1</span>,sam_cnt=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//LL num[MAXX&lt;&lt;1];</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> c)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> p=las;<span class="keyword">int</span> np=las=++sam_cnt;</span><br><span class="line"><span class="comment">//	num[np]=1LL;//此行为计数用，标记出现过几次 </span></span><br><span class="line">	sam[np].len=sam[p].len+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(;p&amp;&amp;!sam[p].ch[c];p=sam[p].fa) sam[p].ch[c]=np;</span><br><span class="line">	<span class="keyword">if</span>(!p) sam[np].fa=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">else</span>{</span><br><span class="line">		<span class="keyword">int</span> q=sam[p].ch[c];</span><br><span class="line">		<span class="keyword">if</span>(sam[q].len==sam[p].len+<span class="number">1</span>) sam[np].fa=q;</span><br><span class="line">		<span class="keyword">else</span>{</span><br><span class="line">			<span class="keyword">int</span> nq=++sam_cnt;sam[nq]=sam[q];</span><br><span class="line">			sam[nq].len=sam[p].len+<span class="number">1</span>;</span><br><span class="line">			sam[q].fa=sam[np].fa=nq;</span><br><span class="line">			<span class="keyword">for</span>(;p&amp;&amp;sam[p].ch[c]==q;p=sam[p].fa) sam[p].ch[c]=nq;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="图论"><a href="#图论" class="headerlink" title="图论"></a>图论</h2><h3 id="堆优化dijkstra最短路"><a href="#堆优化dijkstra最短路" class="headerlink" title="堆优化dijkstra最短路"></a>堆优化<em>dijkstra</em>最短路</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">rode</span>{</span></span><br><span class="line">	<span class="keyword">int</span> to,len;</span><br><span class="line">};</span><br><span class="line"><span class="keyword">int</span> n,dij[MAXX];</span><br><span class="line">vector&lt;rode&gt; ro[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; P;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(<span class="keyword">int</span> st)</span></span>{</span><br><span class="line">	<span class="built_in">memset</span>(dij,Inf,<span class="built_in"><span class="keyword">sizeof</span></span>(dij));</span><br><span class="line">    priority_queue&lt;P,vector&lt;P&gt;,greater&lt;P&gt; &gt; q;</span><br><span class="line">    q.<span class="built_in">emplace</span>(<span class="built_in">P</span>(<span class="number">0</span>,st));</span><br><span class="line">    dij[st]=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">    	P p=q.<span class="built_in">top</span>();q.<span class="built_in">pop</span>();</span><br><span class="line">    	<span class="keyword">int</span> mid=p.second;</span><br><span class="line">    	<span class="keyword">if</span>(dij[mid]&lt;p.first) <span class="keyword">continue</span>; <span class="comment">//括号条件与(dij[mid]!=p.first)等价 </span></span><br><span class="line">    	</span><br><span class="line">    	<span class="keyword">int</span> si=ro[mid].<span class="built_in">size</span>();</span><br><span class="line">    	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;si;++i){</span><br><span class="line">    		<span class="keyword">int</span> too=ro[mid][i].to,lenn=ro[mid][i].len;</span><br><span class="line">    		<span class="keyword">if</span>(dij[too]&gt;dij[mid]+lenn){</span><br><span class="line">    			dij[too]=dij[mid]+lenn;</span><br><span class="line">    			q.<span class="built_in">emplace</span>(<span class="built_in">P</span>(dij[too],too));</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">    </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="Spfa"><a href="#Spfa" class="headerlink" title="Spfa"></a><em>Spfa</em></h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">rode</span>{</span></span><br><span class="line">	<span class="keyword">int</span> to,len;</span><br><span class="line">};</span><br><span class="line"><span class="keyword">int</span> n,in[MAXX],dij[MAXX];</span><br><span class="line"><span class="keyword">bool</span> vis[MAXX];</span><br><span class="line">vector&lt;rode&gt; ro[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> st)</span></span>{</span><br><span class="line">	<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(vis));</span><br><span class="line">	<span class="built_in">memset</span>(in,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(in));</span><br><span class="line">	<span class="built_in">memset</span>(dij,Inf,<span class="built_in"><span class="keyword">sizeof</span></span>(dij));</span><br><span class="line">	queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">	q.<span class="built_in">emplace</span>(st);</span><br><span class="line">	vis[st]=<span class="literal">true</span>;++in[st];dij[st]=<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">		<span class="keyword">int</span> p=q.<span class="built_in">front</span>();q.<span class="built_in">pop</span>();</span><br><span class="line">		vis[p]=<span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">int</span> si=ro[p].<span class="built_in">size</span>();</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;si;++i){</span><br><span class="line">			<span class="keyword">int</span> too=ro[p][i].to,lenn=ro[p][i].len;</span><br><span class="line">			<span class="keyword">if</span>(dij[too]&gt;dij[p]+lenn){</span><br><span class="line">				dij[too]=dij[p]+lenn;</span><br><span class="line">				++in[too];</span><br><span class="line">				<span class="keyword">if</span>(in[too]&gt;=n)</span><br><span class="line">					<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">				<span class="keyword">if</span>(!vis[too]){</span><br><span class="line">					vis[too]=<span class="literal">true</span>;</span><br><span class="line">					q.<span class="built_in">emplace</span>(too);</span><br><span class="line">				}</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="tarjan割点-不是缩点"><a href="#tarjan割点-不是缩点" class="headerlink" title="tarjan割点(不是缩点)"></a><em>tarjan</em>割点(不是缩点)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m,dfn[MAXX],low[MAXX],dfn_cnt;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; to[MAXX];</span><br><span class="line"><span class="keyword">int</span> root;</span><br><span class="line">set&lt;<span class="keyword">int</span>&gt; cut;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> now)</span></span>{ <span class="comment">//每次调用的时候需要更新root的值 </span></span><br><span class="line">	dfn[now]=low[now]=++dfn_cnt;</span><br><span class="line">	<span class="keyword">int</span> si=to[now].<span class="built_in">size</span>(),flag=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;si;++i){</span><br><span class="line">		<span class="keyword">int</span> jj=to[now][i];</span><br><span class="line">		<span class="keyword">if</span>(!dfn[jj]){</span><br><span class="line">			<span class="built_in">tarjan</span>(jj);</span><br><span class="line">			low[now]=<span class="built_in">min</span>(low[now],low[jj]);</span><br><span class="line">			<span class="keyword">if</span>(low[jj]&gt;=dfn[now]){</span><br><span class="line">				++flag;</span><br><span class="line">				<span class="keyword">if</span>(now!=root||flag&gt;<span class="number">1</span>)</span><br><span class="line">					cut.<span class="built_in">emplace</span>(now);</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			low[now]=<span class="built_in">min</span>(low[now],low[jj]);</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="tarjan桥"><a href="#tarjan桥" class="headerlink" title="tarjan桥"></a><em>tarjan</em>桥</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; P;</span><br><span class="line"><span class="keyword">int</span> n,m,dfn[MAXX],dfn_cnt,low[MAXX];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; to[MAXX];</span><br><span class="line">set&lt;P&gt; ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> last)</span></span>{ <span class="comment">//桥 </span></span><br><span class="line">	dfn[now]=low[now]=++dfn_cnt;</span><br><span class="line">	<span class="keyword">int</span> si=to[now].<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;si;++i){</span><br><span class="line">		<span class="keyword">int</span> jj=to[now][i];</span><br><span class="line">		<span class="keyword">if</span>(!dfn[jj]){</span><br><span class="line">			<span class="built_in">tarjan</span>(jj,now);</span><br><span class="line">			low[now]=<span class="built_in">min</span>(low[now],low[jj]);</span><br><span class="line">			<span class="keyword">if</span>(low[jj]&gt;dfn[now]){</span><br><span class="line">				ans.<span class="built_in">emplace</span>(<span class="built_in">P</span>(<span class="built_in">min</span>(now,jj),<span class="built_in">max</span>(now,jj)));</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(jj!=last){</span><br><span class="line">			low[now]=<span class="built_in">min</span>(low[now],dfn[jj]);</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="tarjan缩点-不是割点-有向图"><a href="#tarjan缩点-不是割点-有向图" class="headerlink" title="tarjan缩点(不是割点)(有向图)"></a><em>tarjan</em>缩点(不是割点)(有向图)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m,dfn[MAXX],low[MAXX],dfn_cnt;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; to[MAXX];</span><br><span class="line">stack&lt;<span class="keyword">int</span>&gt; sta;</span><br><span class="line"><span class="keyword">bool</span> in_sta[MAXX];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; scc[MAXX];</span><br><span class="line"><span class="keyword">int</span> scc_cnt,belong[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> now)</span></span>{</span><br><span class="line">	dfn[now]=low[now]=++dfn_cnt;</span><br><span class="line">	sta.<span class="built_in">emplace</span>(now);in_sta[now]=<span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">int</span> si=to[now].<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;si;++i){</span><br><span class="line">		<span class="keyword">int</span> jj=to[now][i];</span><br><span class="line">		<span class="keyword">if</span>(!dfn[jj]){</span><br><span class="line">			<span class="built_in">tarjan</span>(jj);</span><br><span class="line">			low[now]=<span class="built_in">min</span>(low[now],low[jj]);</span><br><span class="line">		}</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(in_sta[jj])</span><br><span class="line">			low[now]=<span class="built_in">min</span>(low[now],low[jj]);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span>(dfn[now]==low[now]){</span><br><span class="line">		++scc_cnt;</span><br><span class="line">		<span class="keyword">int</span> jj=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">while</span>(jj!=now){</span><br><span class="line">			jj=sta.<span class="built_in">top</span>();sta.<span class="built_in">pop</span>();</span><br><span class="line">			scc[scc_cnt].<span class="built_in">emplace_back</span>(jj);</span><br><span class="line">			in_sta[jj]=<span class="literal">false</span>;</span><br><span class="line">			belong[jj]=scc_cnt;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="Kruskal-并查集"><a href="#Kruskal-并查集" class="headerlink" title="Kruskal(并查集)"></a><em>Kruskal</em>(并查集)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>{</span></span><br><span class="line">	<span class="keyword">int</span> st,en,len;</span><br><span class="line">};</span><br><span class="line"><span class="keyword">int</span> n,m,sum,dad[MAXX]; <span class="comment">//n个顶点，m条边  sum为生成树的边的权值之和 </span></span><br><span class="line">Edge a[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(Edge jj,Edge kk)</span></span>{<span class="keyword">return</span> jj.len&lt;kk.len;}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">root</span><span class="params">(<span class="keyword">int</span> jj)</span></span>{</span><br><span class="line">	<span class="keyword">return</span> dad[jj]==jj?jj:dad[jj]=<span class="built_in">root</span>(dad[jj]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">unit</span><span class="params">(<span class="keyword">int</span> jj,<span class="keyword">int</span> kk)</span></span>{</span><br><span class="line">	dad[<span class="built_in">root</span>(jj)]=<span class="built_in">root</span>(kk);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">kruskal</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="built_in">sort</span>(a+<span class="number">1</span>,a+m+<span class="number">1</span>,cmp);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">		dad[i]=i;</span><br><span class="line">	sum=<span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;++i){</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">root</span>(a[i].st)!=<span class="built_in">root</span>(a[i].en)){</span><br><span class="line">			<span class="built_in">unit</span>(a[i].st,a[i].en);</span><br><span class="line">			sum+=a[i].len;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="LCA-最近公共祖先"><a href="#LCA-最近公共祖先" class="headerlink" title="LCA(最近公共祖先)"></a><em>LCA</em>(最近公共祖先)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m,root;</span><br><span class="line"><span class="keyword">int</span> fa[MAXX][<span class="number">22</span>],depth[MAXX];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; to[MAXX];</span><br><span class="line"><span class="keyword">int</span> lg[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;MAXX;++i)</span><br><span class="line">		lg[i]=lg[i<span class="number">-1</span>]+(<span class="number">1</span>&lt;&lt;lg[i<span class="number">-1</span>]==i);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> last)</span></span>{</span><br><span class="line">	fa[now][<span class="number">0</span>]=last;depth[now]=depth[last]+<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=lg[depth[now]];++i)</span><br><span class="line">		fa[now][i]=fa[fa[now][i<span class="number">-1</span>]][i<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">int</span> si=to[now].<span class="built_in">size</span>();</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;si;++i)</span><br><span class="line">		<span class="keyword">if</span>(to[now][i]!=last)</span><br><span class="line">			<span class="built_in">dfs</span>(to[now][i],now);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">LCA</span><span class="params">(<span class="keyword">int</span> jj,<span class="keyword">int</span> kk)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(depth[jj]&gt;depth[kk])</span><br><span class="line">		<span class="built_in">swap</span>(jj,kk);</span><br><span class="line">	<span class="keyword">while</span>(depth[jj]&lt;depth[kk])</span><br><span class="line">		kk=fa[kk][lg[depth[kk]-depth[jj]]<span class="number">-1</span>];</span><br><span class="line">	<span class="keyword">if</span>(jj==kk)</span><br><span class="line">		<span class="keyword">return</span> jj;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=lg[depth[jj]]<span class="number">-1</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">		<span class="keyword">if</span>(fa[jj][i]!=fa[kk][i])</span><br><span class="line">			jj=fa[jj][i],kk=fa[kk][i];</span><br><span class="line">	<span class="keyword">return</span> fa[jj][<span class="number">0</span>];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="匈牙利算法"><a href="#匈牙利算法" class="headerlink" title="匈牙利算法"></a>匈牙利算法</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,m,e; <span class="comment">// n个点和m个点,e条边 </span></span><br><span class="line"><span class="keyword">int</span> match[MAXX]; <span class="comment">// 第二个集合的点i的匹配点为第一个集合的点match[i] </span></span><br><span class="line"><span class="keyword">bool</span> vis[MAXX]; <span class="comment">// 第二个集合的点i是否被访问过 </span></span><br><span class="line">set&lt;<span class="keyword">int</span>&gt; to[MAXX]; <span class="comment">// 邻接表存图，在这里用set是为了防止重边，平时用vector即可</span></span><br><span class="line">				   <span class="comment">// 这里只记录从左到右的边即可 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> now)</span></span>{</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> jj:to[now]){</span><br><span class="line">		<span class="keyword">if</span>(!vis[jj]){</span><br><span class="line">			vis[jj]=<span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span>(match[jj]==<span class="number">0</span>||<span class="built_in">find</span>(match[jj])){</span><br><span class="line">				match[jj]=now;</span><br><span class="line">				<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			}</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Hungarian</span><span class="params">()</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		<span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(vis));</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">find</span>(i)) ++ret;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//int ans=HunGaria(); // ans即为最大匹配数</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="树状数组-树剖"><a href="#树状数组-树剖" class="headerlink" title="树状数组+树剖"></a>树状数组+树剖</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//树状数组+树剖</span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line">LL mod,a[MAXX];</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt; to[MAXX];</span><br><span class="line"><span class="comment">//树状数组</span></span><br><span class="line">LL c1[MAXX],c2[MAXX];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span></span>{</span><br><span class="line">    <span class="keyword">return</span> x&amp;(-x);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,<span class="keyword">int</span> x)</span></span>{</span><br><span class="line">    x %= mod;</span><br><span class="line">    <span class="keyword">int</span> ad1 = (LL)(l<span class="number">-1</span>)*x%mod;</span><br><span class="line">    <span class="keyword">int</span> ad2 = (LL)r*x%mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> t=l;t&lt;=n;t+=<span class="built_in">lowbit</span>(t)){</span><br><span class="line">        c1[t] = (c1[t]+x)%mod;</span><br><span class="line">        c2[t] = (c2[t]+ad1)%mod;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> t=r+<span class="number">1</span>;t&lt;=n;t+=<span class="built_in">lowbit</span>(t)){</span><br><span class="line">        c1[t] = (c1[t]-x)%mod;</span><br><span class="line">        c1[t] = (c1[t]+mod)%mod;</span><br><span class="line">        c2[t] = (c2[t]-ad2)%mod;</span><br><span class="line">        c2[t] = (c2[t]+mod)%mod;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qwq</span><span class="params">(<span class="keyword">int</span> i)</span></span>{ <span class="comment">//qwq</span></span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> t=i;t&gt;<span class="number">0</span>;t-=<span class="built_in">lowbit</span>(t)){</span><br><span class="line">        res = (res+(LL)i*c1[t]%mod)%mod;</span><br><span class="line">        res = (res-c2[t])%mod;</span><br><span class="line">        res = (res+mod)%mod;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">    <span class="keyword">int</span> res = (<span class="built_in">qwq</span>(r)-<span class="built_in">qwq</span>(l<span class="number">-1</span>))%mod;</span><br><span class="line">    <span class="keyword">return</span> (res+mod)%mod;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//树剖</span></span><br><span class="line"><span class="keyword">int</span> depth[MAXX],num[MAXX],son[MAXX],fa[MAXX];</span><br><span class="line"><span class="keyword">int</span> top[MAXX],id[MAXX];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> fa)</span></span>{</span><br><span class="line">	depth[now]=depth[::fa[now]=fa]+<span class="number">1</span>;</span><br><span class="line">	num[now]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">int</span> maxnum=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> jj:to[now]){</span><br><span class="line">		<span class="keyword">if</span>(jj==fa) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs1</span>(jj,now);</span><br><span class="line">		num[now]+=num[jj];</span><br><span class="line">		<span class="keyword">if</span>(num[jj]&gt;maxnum){</span><br><span class="line">			son[now]=jj;</span><br><span class="line">			maxnum=num[jj];</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now,<span class="keyword">int</span> t)</span></span>{</span><br><span class="line">	top[now]=t;</span><br><span class="line">	id[now]=++cnt;</span><br><span class="line">	<span class="keyword">if</span>(a[now])</span><br><span class="line">		<span class="built_in">add</span>(id[now],id[now],a[now]);</span><br><span class="line">	<span class="keyword">if</span>(son[now])</span><br><span class="line">		<span class="built_in">dfs2</span>(son[now],t);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> jj:to[now]){</span><br><span class="line">		<span class="keyword">if</span>(jj==son[now]||jj==fa[now]) <span class="keyword">continue</span>;</span><br><span class="line">		<span class="built_in">dfs2</span>(jj,jj);</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> root)</span></span>{<span class="comment">//root为根节点</span></span><br><span class="line">	<span class="built_in">dfs1</span>(root,<span class="number">0</span>);</span><br><span class="line">	<span class="built_in">dfs2</span>(root,root);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addpath</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r,LL jk)</span></span>{<span class="comment">//从l到r的最短路上的所有节点都加上jk</span></span><br><span class="line">	<span class="keyword">while</span>(top[l]!=top[r]){</span><br><span class="line">		<span class="keyword">if</span>(depth[top[l]]&lt;depth[top[r]])</span><br><span class="line">			<span class="built_in">swap</span>(l,r);</span><br><span class="line">		<span class="built_in">add</span>(id[top[l]],id[l],jk);</span><br><span class="line">		l=fa[top[l]];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span>(depth[l]&gt;depth[r])</span><br><span class="line">		<span class="built_in">swap</span>(l,r);</span><br><span class="line">	<span class="built_in">add</span>(id[l],id[r],jk);</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">getsum</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{<span class="comment">//求从l到r的最短路上的所有节点的和</span></span><br><span class="line">	LL ret=<span class="number">0LL</span>;</span><br><span class="line">	<span class="keyword">while</span>(top[l]!=top[r]){</span><br><span class="line">		<span class="keyword">if</span>(depth[top[l]]&lt;depth[top[r]])</span><br><span class="line">			<span class="built_in">swap</span>(l,r);</span><br><span class="line">		ret=(ret+<span class="built_in">query</span>(id[top[l]],id[l]))%mod;</span><br><span class="line">		l=fa[top[l]];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">if</span>(depth[l]&gt;depth[r])</span><br><span class="line">		<span class="built_in">swap</span>(l,r);</span><br><span class="line">	ret=(ret+<span class="built_in">query</span>(id[l],id[r]))%mod;</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">addtree</span><span class="params">(<span class="keyword">int</span> x,LL jk)</span></span>{<span class="comment">//x的子树的所有节点都加上jk</span></span><br><span class="line">	<span class="built_in">add</span>(id[x],id[x]+num[x]<span class="number">-1</span>,jk);</span><br><span class="line">}</span><br><span class="line"><span class="function">LL <span class="title">getsum</span><span class="params">(<span class="keyword">int</span> x)</span></span>{<span class="comment">//求x的子树的所有节点的和</span></span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">query</span>(id[x],id[x]+num[x]<span class="number">-1</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="数论"><a href="#数论" class="headerlink" title="数论"></a>数论</h2><h3 id="欧拉筛存-lt-nn-的素数"><a href="#欧拉筛存-lt-nn-的素数" class="headerlink" title="欧拉筛存(<=nn)的素数"></a>欧拉筛存(&lt;=nn)的素数</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a[MAXX],m;</span><br><span class="line"><span class="keyword">bool</span> vis[MAXX]; <span class="comment">//vis[i]=true; 表示i为合数 </span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ola</span><span class="params">(<span class="keyword">int</span> nn)</span></span>{</span><br><span class="line">    m=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=nn;++i){</span><br><span class="line">		<span class="keyword">if</span>(!vis[i])</span><br><span class="line">			a[++m]=i;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=m&amp;&amp;i*a[j]&lt;=nn;++j){</span><br><span class="line">			vis[i*a[j]]=<span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">if</span>(i%a[j]==<span class="number">0</span>)</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">		}</span><br><span class="line">	}</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">LL <span class="title">fastpow</span><span class="params">(LL jj,LL kk)</span></span>{</span><br><span class="line">	LL ret=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(kk){</span><br><span class="line">		<span class="keyword">if</span>(kk&amp;<span class="number">1</span>) ret=ret*jj%mod;</span><br><span class="line">		jj=jj*jj%mod;</span><br><span class="line">		kk&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="线性基-解决最大最小异或和问题"><a href="#线性基-解决最大最小异或和问题" class="headerlink" title="线性基(解决最大最小异或和问题)"></a>线性基(解决最大最小异或和问题)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">LL d[<span class="number">70</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">62</span>;++i)</span><br><span class="line">        d[i]=<span class="number">0LL</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(LL jj)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">62</span>;i&gt;=<span class="number">0</span>;--i){</span><br><span class="line">        <span class="keyword">if</span>(jj&amp;(<span class="number">1LL</span>&lt;&lt;i)){</span><br><span class="line">            <span class="keyword">if</span>(!d[i]){</span><br><span class="line">                d[i]=jj;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">            jj^=d[i];</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">getmax</span><span class="params">()</span></span>{</span><br><span class="line">    LL ret=<span class="number">0LL</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">62</span>;i&gt;=<span class="number">0</span>;--i)</span><br><span class="line">        ret=<span class="built_in">max</span>(ret,ret^d[i]);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">geimin</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">62</span>;++i)</span><br><span class="line">        <span class="keyword">if</span>(d[i])</span><br><span class="line">            <span class="keyword">return</span> d[i];</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="模意义下的逆元"><a href="#模意义下的逆元" class="headerlink" title="模意义下的逆元"></a>模意义下的逆元</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//模意义下的逆元 </span></span><br><span class="line"><span class="keyword">const</span> LL mod=<span class="number">1000000007</span>;</span><br><span class="line"><span class="function">LL <span class="title">fastpow</span><span class="params">(LL jj,LL kk)</span></span>{</span><br><span class="line">	LL ret=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(kk){</span><br><span class="line">		<span class="keyword">if</span>(kk&amp;<span class="number">1</span>) ret=ret*jj%mod;</span><br><span class="line">		jj=jj*jj%mod;</span><br><span class="line">		kk&gt;&gt;=<span class="number">1</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">rev</span><span class="params">(LL jj)</span></span>{</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">fastpow</span>(jj,mod<span class="number">-2</span>);</span><br><span class="line">}</span><br><span class="line"><span class="comment">//(1/2)%mod=rev(2)</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="错位排序公式"><a href="#错位排序公式" class="headerlink" title="错位排序公式"></a>错位排序公式</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d[<span class="number">1</span>]=<span class="number">0</span>;d[<span class="number">2</span>]=<span class="number">1</span>;</span><br><span class="line">d[i]=(n<span class="number">-1</span>)*(d[i<span class="number">-1</span>]+d[i<span class="number">-2</span>]);</span><br></pre></td></tr></tbody></table></figure>



<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><h3 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,c[MAXX];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> jj)</span></span>{<span class="keyword">return</span> (jj)&amp;(-jj);}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(<span class="keyword">int</span> jj,<span class="keyword">int</span> kk)</span></span>{</span><br><span class="line">	<span class="keyword">while</span>(jj&lt;=n){</span><br><span class="line">		c[jj]+=kk;</span><br><span class="line">		jj+=<span class="built_in">lowbit</span>(jj);</span><br><span class="line">	}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getsum</span><span class="params">(<span class="keyword">int</span> jj)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> ret=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span>(jj&gt;<span class="number">0</span>){</span><br><span class="line">		ret+=c[jj];</span><br><span class="line">		jj-=<span class="built_in">lowbit</span>(jj);</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="线段树MIN-单点修改"><a href="#线段树MIN-单点修改" class="headerlink" title="线段树MIN(单点修改=)"></a>线段树MIN(单点修改=)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">LL n,a[MAXX],tree[MAXX&lt;&lt;<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_up</span><span class="params">(LL rt)</span></span>{</span><br><span class="line">	tree[rt]=<span class="built_in">min</span>(tree[rt&lt;&lt;<span class="number">1</span>],tree[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(LL l,LL r,LL rt)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(l==r){</span><br><span class="line">		tree[rt]=a[l];</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	}</span><br><span class="line">	LL mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="built_in">build</span>(l,mid,rt&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">build</span>(mid+<span class="number">1</span>,r,rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">push_up</span>(rt);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">updata</span><span class="params">(LL L,LL jj,LL l,LL r,LL rt)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(L==l&amp;&amp;r==L){</span><br><span class="line">		tree[rt]=jj;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	}</span><br><span class="line">	LL mid=(l+r)&gt;&gt;<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=mid)</span><br><span class="line">		<span class="built_in">updata</span>(L,jj,l,mid,rt&lt;&lt;<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">updata</span>(L,jj,mid+<span class="number">1</span>,r,rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">push_up</span>(rt);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">getmin</span><span class="params">(LL L,LL R,LL l,LL r,LL rt)</span></span>{</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=l&amp;&amp;R&gt;=r){</span><br><span class="line">		<span class="keyword">return</span> tree[rt];</span><br><span class="line">	}</span><br><span class="line">	LL mid=(l+r)&gt;&gt;<span class="number">1</span>,ret=Inf;</span><br><span class="line">	<span class="keyword">if</span>(L&lt;=mid)</span><br><span class="line">		ret=<span class="built_in">min</span>(ret,<span class="built_in">getmin</span>(L,R,l,mid,rt&lt;&lt;<span class="number">1</span>));</span><br><span class="line">	<span class="keyword">if</span>(R&gt;mid)</span><br><span class="line">		ret=<span class="built_in">min</span>(ret,<span class="built_in">getmin</span>(L,R,mid+<span class="number">1</span>,r,rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>));</span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//build(1,n,1);</span></span><br><span class="line"><span class="comment">//updata(l,k,1,n,1);</span></span><br><span class="line"><span class="comment">//getmin(l,r,1,n,1);</span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="st表-max"><a href="#st表-max" class="headerlink" title="st表(max)"></a>st表(max)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n,a[MAXX];</span><br><span class="line"><span class="keyword">int</span> mn[MAXX],stmax[MAXX][<span class="number">22</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">	mn[<span class="number">0</span>]=<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">		mn[i]=((i&amp;(i<span class="number">-1</span>))==<span class="number">0</span>)?mn[i<span class="number">-1</span>]+<span class="number">1</span>:mn[i<span class="number">-1</span>];</span><br><span class="line">		stmax[i][<span class="number">0</span>]=a[i];</span><br><span class="line">	}</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=mn[n];++j)</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>&lt;=n;++i)</span><br><span class="line">			stmax[i][j]=<span class="built_in">max</span>(stmax[i][j<span class="number">-1</span>],stmax[i+(<span class="number">1</span>&lt;&lt;(j<span class="number">-1</span>))][j<span class="number">-1</span>]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getstmax</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>{</span><br><span class="line">	<span class="keyword">int</span> k=mn[r-l+<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">max</span>(stmax[l][k],stmax[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="fread快读"><a href="#fread快读" class="headerlink" title="fread快读"></a>fread快读</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">char</span> buf[<span class="number">100000</span>],*pa=buf,*pd=buf;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> gc pa==pd&amp;&amp;(pd=(pa=buf)+fread(buf,1,100000,stdin),pa==pd)?EOF:*pa++</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">x</span><span class="params">(<span class="number">0</span>)</span></span>;<span class="function"><span class="keyword">char</span> <span class="title">c</span><span class="params">(gc)</span></span>;</span><br><span class="line">    <span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>)c=gc;</span><br><span class="line">    <span class="keyword">while</span>(c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>)x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>),c=gc;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="数位dp"><a href="#数位dp" class="headerlink" title="数位dp"></a>数位dp</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">LL num[<span class="number">20</span>],dp[<span class="number">20</span>][<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">dfs</span><span class="params">(LL now,<span class="keyword">bool</span> limit,<span class="keyword">bool</span> nozero,LL sum,LL d)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(!now) <span class="keyword">return</span> sum;</span><br><span class="line">    <span class="keyword">if</span>(!limit&amp;&amp;nozero&amp;&amp;dp[now][sum]!=<span class="number">-1</span>) <span class="keyword">return</span> dp[now][sum];</span><br><span class="line">    LL ret=<span class="number">0LL</span>;</span><br><span class="line">    LL up=limit?num[now]:<span class="number">9</span>;</span><br><span class="line">    <span class="keyword">for</span>(LL i=<span class="number">0</span>;i&lt;=up;++i)</span><br><span class="line">        ret+=<span class="built_in">dfs</span>(now<span class="number">-1</span>,limit&amp;&amp;(i==up),nozero||i,sum+(<span class="keyword">bool</span>)((nozero||i)&amp;&amp;(i==d)),d);</span><br><span class="line">    <span class="keyword">if</span>(!limit&amp;&amp;nozero) dp[now][sum]=ret;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">getans</span><span class="params">(LL x,LL d)</span></span>{<span class="comment">//从1到x的所有数中数字d出现的次数</span></span><br><span class="line">    LL p=<span class="number">0LL</span>;</span><br><span class="line">    <span class="built_in">memset</span>(dp,<span class="number">-1</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(dp));</span><br><span class="line">    <span class="keyword">while</span>(x){</span><br><span class="line">        num[++p]=x%<span class="number">10</span>;</span><br><span class="line">        x/=<span class="number">10</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">dfs</span>(p,<span class="literal">true</span>,<span class="literal">false</span>,<span class="number">0LL</span>,d);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="二分-左闭右开"><a href="#二分-左闭右开" class="headerlink" title="二分(左闭右开)"></a>二分(左闭右开)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> l=<span class="number">1</span>,r=n+<span class="number">1</span>,mid;<span class="comment">//[l,r)</span></span><br><span class="line"><span class="keyword">while</span>(l&lt;r){</span><br><span class="line">    mid=(l+r)/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check</span>(mid))</span><br><span class="line">        l=mid+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        r=mid;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>



<h3 id="离散化-最终包含重复元素"><a href="#离散化-最终包含重复元素" class="headerlink" title="离散化(最终包含重复元素)"></a>离散化(最终包含重复元素)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]);</span><br><span class="line"></span><br><span class="line"><span class="comment">//包含重复元素 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    s[i]=a[i];<span class="comment">//a[]为原数组 </span></span><br><span class="line"><span class="built_in">sort</span>(a+<span class="number">1</span>,a+n+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">int</span> len=<span class="built_in">unique</span>(a+<span class="number">1</span>,a+n+<span class="number">1</span>)-a<span class="number">-1</span>;<span class="comment">//去重之后的数组长度 </span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    s[i]=<span class="built_in">lower_bound</span>(a+<span class="number">1</span>,a+len+<span class="number">1</span>,s[i])-a;<span class="comment">//s[]即为离散化之后的数组 </span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="离散化-最终不包含重复元素"><a href="#离散化-最终不包含重复元素" class="headerlink" title="离散化(最终不包含重复元素)"></a>离散化(最终不包含重复元素)</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i].first);<span class="comment">//P a[MAXX]</span></span><br><span class="line">    a[i].second=i;</span><br><span class="line">}</span><br><span class="line"><span class="built_in">sort</span>(a+<span class="number">1</span>,a+n+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line">    s[a[i].second]=i;<span class="comment">//s[]即为离散化之后的结果 </span></span><br></pre></td></tr></tbody></table></figure>



<h3 id="unordered-map中存pair"><a href="#unordered-map中存pair" class="headerlink" title="unordered_map中存pair"></a>unordered_map中存pair</h3><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">hashfunc</span>{</span></span><br><span class="line">    <span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> U&gt;</span></span><br><span class="line"><span class="function">    <span class="keyword">size_t</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="keyword">const</span> pair&lt;T, U&gt; &amp;i)</span> <span class="keyword">const</span> </span>{</span><br><span class="line">        <span class="comment">//根据题目数据写一个hash函数</span></span><br><span class="line">        <span class="keyword">return</span> (LL)(i.first)*<span class="number">1000000LL</span>+(LL)(i.second);</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line">unordered_map&lt;P,<span class="keyword">int</span>,hashfunc&gt; dij;</span><br></pre></td></tr></tbody></table></figure>


                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Shaun</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://shaun-2314.github.io/2022/04/22/template-summary/">http://shaun-2314.github.io/2022/04/22/template-summary/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Shaun</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/acm/">
                                    <span class="chip bg-color">acm</span>
                                </a>
                            
                                <a href="/tags/%E6%9D%BF%E5%AD%90/">
                                    <span class="chip bg-color">板子</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    
        <style>
    .waline-card {
        margin: 1.5rem auto;
    }
    .waline-card .card-content {
        padding: 20px 20px 5px 20px;
    }

    #waline p {
        margin: 2px 2px 10px;
        font-size: 1.05rem;
        line-height: 1.78rem;
    }
    #waline blockquote p {
        text-indent: 0.2rem;
    }
    #waline a {
        padding: 0 2px;
        color: #4cbf30;
        font-weight: 500;
        text-decoration: none;
    }
    #waline img {
        max-width: 100%;
        cursor: pointer;
    }
    #waline ol li {
        list-style-type: decimal;
    }
    #waline ol,
    ul {
        display: block;
        padding-left: 2em;
        word-spacing: 0.05rem;
    }
    #waline ul li,
    ol li {
        display: list-item;
        line-height: 1.8rem;
        font-size: 1rem;
    }
    #waline ul li {
        list-style-type: disc;
    }
    #waline ul ul li {
        list-style-type: circle;
    }
    #waline table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }
    #waline table, th, td {
        border: 0;
    }
    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }
    #waline table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }
    #waline table td {
        min-width: 80px;
    }
    #waline h1 {
        font-size: 1.85rem;
        font-weight: bold;
        line-height: 2.2rem;
    }
    #waline h2 {
        font-size: 1.65rem;
        font-weight: bold;
        line-height: 1.9rem;
    }
    #waline h3 {
        font-size: 1.45rem;
        font-weight: bold;
        line-height: 1.7rem;
    }
    #waline h4 {
        font-size: 1.25rem;
        font-weight: bold;
        line-height: 1.5rem;
    }
    #waline h5 {
        font-size: 1.1rem;
        font-weight: bold;
        line-height: 1.4rem;
    }
    #waline h6 {
        font-size: 1rem;
        line-height: 1.3rem;
    }
    #waline p {
        font-size: 1rem;
        line-height: 1.5rem;
    }
    #waline hr {
        margin: 12px 0;
        border: 0;
        border-top: 1px solid #ccc;
    }
    #waline blockquote {
        margin: 15px 0;
        border-left: 5px solid #42b983;
        padding: 1rem 0.8rem 0.3rem 0.8rem;
        color: #666;
        background-color: rgba(66, 185, 131, .1);
    }
    #waline pre {
        font-family: monospace, monospace;
        padding: 1.2em;
        margin: .5em 0;
        background: #272822;
        overflow: auto;
        border-radius: 0.3em;
        tab-size: 4;
    }
    #waline code {
        font-family: monospace, monospace;
        padding: 1px 3px;
        font-size: 0.92rem;
        color: #e96900;
        background-color: #f8f8f8;
        border-radius: 2px;
    }
    #waline pre code {
        font-family: monospace, monospace;
        padding: 0;
        color: #e8eaf6;
        background-color: #272822;
    }
    #waline pre[class*="language-"] {
        padding: 1.2em;
        margin: .5em 0;
    }
    #waline code[class*="language-"],
    pre[class*="language-"] {
        color: #e8eaf6;
    }
    #waline [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
    #waline b,
    strong {
        font-weight: bold;
    }
    #waline dfn {
        font-style: italic;
    }
    #waline small {
        font-size: 85%;
    }
    #waline cite {
        font-style: normal;
    }
    #waline mark {
        background-color: #fcf8e3;
        padding: .2em;
    }
    #waline table, th, td {
        padding: 12px 13px;
        border: 1px solid #dfe2e5;
    }
    table tr:nth-child(2n), thead {
        background-color: #fafafa;
    }
    #waline table th {
        background-color: #f2f2f2;
        min-width: 80px;
    }
    #waline table td {
        min-width: 80px;
    }
    #waline [type="checkbox"]:not(:checked), [type="checkbox"]:checked {
        position: inherit;
        margin-left: -1.3rem;
        margin-right: 0.4rem;
        margin-top: -1px;
        vertical-align: middle;
        left: unset;
        visibility: visible;
    }
  </style>
  
  <div class="card waline-card" data-aos="fade-up">
    <div class="comment_headling" style="font-size: 20px; font-weight: 700; position: relative; padding-left: 20px; top: 15px; padding-bottom: 5px;">
        <i class="fas fa-comments fa-fw" aria-hidden="true"></i>
        <span>评论</span>
    </div>
    <div id="waline" class="card-content" style="display: grid">
    </div>
  </div>
  

  <!-- <script src="//cdn.jsdelivr.net/npm/@waline/client"></script> -->
  <script src="/libs/waline/Waline.min.js"></script>
  <script>
    new Waline({
        el: '#waline',
        serverURL: 'https://blog-contact-gbmvik3ra-shaun-2314.vercel.app/',
        avatar: 'mm'    
    });
  </script> 
    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2022/06/08/childhool-dream-thinking/">
                    <div class="card-image">
                        
                        <img src="https://lc-gluttony.s3.amazonaws.com/SXOgBwqJunqG/rX9cfTzC6PnhlLxkqX03D1Bmz8yzW7Xg/childhool-dream-thinking.webp" class="responsive-img" alt="还记得小时候的梦想吗">
                        
                        <span class="card-title">还记得小时候的梦想吗</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-06-08
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E4%B8%80%E4%BA%9B%E6%84%9F%E6%82%9F/" class="post-category">
                                    一些感悟
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%A2%A6%E6%83%B3/">
                        <span class="chip bg-color">梦想</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/04/22/cfround-784-div-4-summary/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="纪念第一次AK">
                        
                        <span class="card-title">纪念第一次AK</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-04-22
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/cf%E6%80%BB%E7%BB%93/" class="post-category">
                                    cf总结
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/acm/">
                        <span class="chip bg-color">acm</span>
                    </a>
                    
                    <a href="/tags/cf/">
                        <span class="chip bg-color">cf</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="https://cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="tencent"
                   type="playlist"
                   id="8464980395"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.6'
                   list-folded='false'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">Shaun</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">39.9k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/shaun-2314" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1034024101@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1034024101" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1034024101" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
